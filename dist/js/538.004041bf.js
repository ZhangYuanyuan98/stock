"use strict";(self["webpackChunkstock"]=self["webpackChunkstock"]||[]).push([[538],{4471:function(t,a,e){e.r(a),e.d(a,{default:function(){return p}});var o=function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"app"}},[a("TopNavbar"),a("el-container",{staticStyle:{width:"100%",border:"1px solid #eee",display:"flex","justify-content":"center"}},[a("SideBar"),a("el-main",[a("div",{staticClass:"search-container"},[a("el-input",{attrs:{placeholder:"请输入股票代码","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.input,callback:function(a){t.input=a},expression:"input"}})],1),a("div",{ref:"tableWrapper",staticClass:"table-wrapper",on:{scroll:t.handleScroll}},[a("el-table",{staticClass:"custom-table",attrs:{data:t.tableData,border:""},on:{"row-click":t.handleRowClick}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"symbol",label:"股票名称",width:"80"}}),a("el-table-column",{attrs:{prop:"stock_name",label:"股票代码",width:"80"}}),a("el-table-column",{attrs:{prop:"daily_data",label:"日k(元)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"amount_data",label:"成交量(手)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"amount-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"vol_data",label:"成交额(元)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"vol-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"flow_data",label:"流入流出资金(元)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"flow-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"change_range_data",label:"涨跌幅(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"changeRange-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"change_amount_data",label:"涨跌额(元)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"changeAmount-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"amplitude_data",label:"振幅(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"amplitude-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"changeProportion",label:"涨跌比例(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"changeProportion-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"turnover",label:"换手率(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"turnover-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"flow_main_data",label:"主力资金比例(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"flowMain-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"flow_retail_data",label:"散户资金比例(%)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"flowRetail-candlestick-chart-"+t.$index}})]}}])}),a("el-table-column",{attrs:{prop:"weekly_data",label:"周k(元)"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"chart-container",attrs:{id:"weekly-candlestick-chart-"+t.$index}})]}}])})],1)],1),a("el-backtop",{attrs:{target:".table-wrapper",bottom:100}},[a("div",{staticClass:"el-backtop",staticStyle:{right:"40px",bottom:"100px"}},[a("div",{staticStyle:{width:"100%","background-color":"rgb(242, 245, 246)","box-shadow":"rgba(0, 0, 0, 0.12) 0px 0px 6px","text-align":"center","line-height":"40px",color:"rgb(25, 137, 250)"}},[t._v(" ↑")])])])],1)],1)],1)},i=[],r=(e(4114),e(4603),e(7566),e(8721),e(9671)),l=e(2599),n=e(8158),s=e(6373),c={components:{TopNavbar:l.A,SideBar:n.A},props:{type:{type:String,required:!0}},data(){return{input:"",tableData:[],followedStocks:[],blackStocks:[],currentPage:1,pageSize:10,totalItemNum:0,loading:!1,hasMore:!0,justLoadedMore:!1}},beforeCreate(){window.addEventListener("popstate",(()=>{window.location.reload()}))},mounted(){setTimeout((()=>{this.fetchData()}),100)},methods:{async onSearch(){const t={symbol:this.input},a=await(0,s.Zv)(t,"/api/stock_real_time");console.log(a.data),200===a.status&&null!==a.data.stock_name?this.$router.push({path:"/api/board_cons_detail",query:{symbol:this.input}}):this.$notify.error({title:"错误",message:"未找到股票信息"})},handleRowClick(t){const a=t.symbol;this.$router.push({path:"/api/board_cons_detail",query:{symbol:a}})},async fetchData(){if(!this.loading&&this.hasMore&&!this.justLoadedMore){this.isLoadingMore=!0;const t={currentPage:this.currentPage,pageSize:this.pageSize};let a;switch(this.type){case"stock_list":a=await(0,s.Zv)(t,"/api/stock_list");break;case"stock_followed":a=await(0,s.b6)(this.handleFollowedList("followedStocks").searchParams,"/api/stock_followed"),console.log("Fetched stocks:",this.handleFollowedList("followedStocks").searchParams.toString());break;case"stock_black":a=await(0,s.b6)(this.handleBlackList("blackStocks").searchParams,"/api/stock_black"),console.log("Fetched blacklisted stocks:",this.handleBlackList("blackStocks").searchParams.toString());break;default:return console.error("Invalid type:",this.type),void(this.loading=!1)}if(a&&a.data){const t=a.data.data;this.tableData.push(...t),this.totalItemNum=a.data.totalItemNum,this.hasMore=a.data.data.length===this.pageSize,this.justLoadedMore=!0,this.currentPage*this.pageSize>=this.totalItemNum?this.isLoadingMore=!1:this.currentPage++,this.justLoadedMore=!1,this.initCandlestickCharts(),this.$nextTick((()=>{this.$refs.tableWrapper.scrollTop=this.lastScrollTop}))}else this.isLoadingMore=!1}},handleFollowedList(){const t="followedStocks",a=JSON.parse(localStorage.getItem(t)||"[]"),e=a.filter((t=>t&&"string"===typeof t&&t.trim())),o=new URLSearchParams;return e.forEach((t=>o.append("followed",t))),{followed:e,searchParams:o}},handleBlackList(){const t="blackStocks",a=JSON.parse(localStorage.getItem(t)||"[]"),e=a.filter((t=>t&&"string"===typeof t&&t.trim())),o=new URLSearchParams;return e.forEach((t=>o.append("blacklisted",t))),{blacklisted:e,searchParams:o}},handleScroll(){const t=this.$refs.tableWrapper;if(t){const a=t.scrollTop,e=t.clientHeight,o=t.scrollHeight;a+e>=o&&(this.lastScrollTop=a,this.fetchData())}},handleChartInstance(t,a,e){let o=r.FP(t);o&&o.dispose(),o=r.Ts(t);const i=e();o.setOption(i)},initCandlestickCharts(){this.$nextTick((()=>{this.tableData.forEach(((t,a)=>{if(t.daily_data&&Array.isArray(t.daily_data)&&t.daily_data.length>0&&null!==t.daily_data[0]){const e=document.querySelector(`#candlestick-chart-${a}`);this.handleChartInstance(e,t.daily_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{min:function(t){var a=t.min;return.95*a},max:function(t){var a=t.max;return 1.05*a},axisLabel:{showMinLabel:!1,showMaxLabel:!1,show:!0,fontSize:8,margin:0},type:"value",splitLine:{show:!0,lineStyle:{color:"#ddd",type:"solid",width:1}}},series:[{type:"candlestick",data:t.daily_data.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]})))}if(t.weekly_data&&Array.isArray(t.weekly_data)&&t.weekly_data.length>0&&null!==t.weekly_data[0]){const e=document.querySelector(`#weekly-candlestick-chart-${a}`);this.handleChartInstance(e,t.weekly_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{min:function(t){var a=t.min;return.95*a},max:function(t){var a=t.max;return 1.05*a},axisLabel:{showMinLabel:!1,showMaxLabel:!1,show:!0,fontSize:8,margin:0},type:"value",splitLine:{show:!0,lineStyle:{color:"#ddd",type:"solid",width:1}}},series:[{type:"candlestick",data:t.weekly_data.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]})))}if(t.flow_data&&Array.isArray(t.flow_data)&&t.flow_data.length>0&&null!==t.flow_data[0]){const e=document.querySelector(`#flow-candlestick-chart-${a}`),o=Math.max(...t.flow_data.map((t=>Math.abs(t["流入资金净额"])))),i=Math.floor(Math.log10(o));this.handleChartInstance(e,t.flow_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:0,formatter:function(t){const a=t/Math.pow(10,i);return a.toFixed(1)}},type:"value",name:`*10^${i}`,nameLocation:"end",nameTextStyle:{fontSize:8,padding:[0,0,0,30]},nameGap:-4},series:[{type:"bar",data:t.flow_data.map((t=>t["流入资金净额"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.flow_main_data&&Array.isArray(t.flow_main_data)&&t.flow_main_data.length>0&&null!==t.flow_main_data[0]){const e=document.querySelector(`#flowMain-candlestick-chart-${a}`);this.handleChartInstance(e,t.flow_main_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.flow_main_data.map((t=>t["主力净流入-净占比"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.flow_retail_data&&Array.isArray(t.flow_retail_data)&&t.flow_retail_data.length>0&&null!==t.flow_retail_data[0]){const e=document.querySelector(`#flowRetail-candlestick-chart-${a}`);this.handleChartInstance(e,t.flow_retail_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.flow_retail_data.map((t=>t["小单净流入-净占比"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.amount_data&&Array.isArray(t.amount_data)&&t.amount_data.length>0&&null!==t.amount_data[0]){const e=document.querySelector(`#amount-candlestick-chart-${a}`),o=Math.max(...t.amount_data.map((t=>t["成交量"]))),i=Math.floor(Math.log10(o));this.handleChartInstance(e,t.amount_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:0,formatter:function(t){const a=t/Math.pow(10,i);return a.toFixed(1)}},splitNumber:3,type:"value",name:`*10^${i}`,nameLocation:"end",nameTextStyle:{fontSize:8,padding:[0,0,0,30]},nameGap:-4},series:[{type:"bar",data:t.amount_data.map((t=>t["成交量"]))}]})))}if(t.vol_data&&Array.isArray(t.vol_data)&&t.vol_data.length>0&&null!==t.vol_data[0]){const e=document.querySelector(`#vol-candlestick-chart-${a}`),o=Math.max(...t.vol_data.map((t=>t["成交额"]))),i=Math.floor(Math.log10(o));this.handleChartInstance(e,t.vol_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:0,formatter:function(t){const a=t/Math.pow(10,i);return a.toFixed(1)}},splitNumber:3,type:"value",name:`*10^${i}`,nameLocation:"end",nameTextStyle:{fontSize:8,padding:[0,0,0,30]},nameGap:-4},series:[{type:"bar",data:t.vol_data.map((t=>t["成交额"]))}]})))}if(t.change_range_data&&Array.isArray(t.change_range_data)&&t.change_range_data.length>0&&null!==t.change_range_data[0]){const e=document.querySelector(`#changeRange-candlestick-chart-${a}`);this.handleChartInstance(e,t.change_range_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.change_range_data.map((t=>t["涨跌幅"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.change_amount_data&&Array.isArray(t.change_amount_data)&&t.change_amount_data.length>0&&null!==t.change_amount_data[0]){const e=document.querySelector(`#changeAmount-candlestick-chart-${a}`);this.handleChartInstance(e,t.change_amount_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.change_amount_data.map((t=>t["涨跌额"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.amplitude_data&&Array.isArray(t.amplitude_data)&&t.amplitude_data.length>0&&null!==t.amplitude_data[0]){const e=document.querySelector(`#amplitude-candlestick-chart-${a}`);this.handleChartInstance(e,t.amplitude_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.amplitude_data.map((t=>t["振幅"]))}]})))}if(t.change_proportion_data&&Array.isArray(t.change_proportion_data)&&t.change_proportion_data.length>0&&null!==t.change_proportion_data[0]){const e=document.querySelector(`#changeProportion-candlestick-chart-${a}`);this.handleChartInstance(e,t.change_proportion_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.change_proportion_data.map((t=>t["涨跌比例"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]})))}if(t.turnover_data&&Array.isArray(t.turnover_data)&&t.turnover_data.length>0&&null!==t.turnover_data[0]){const e=document.querySelector(`#turnover-candlestick-chart-${a}`);this.handleChartInstance(e,t.turnover_data,(()=>({grid:{left:"20%",right:"10%",top:"5%",bottom:"5%"},xAxis:{axisLabel:{show:!1},type:"category",axisTick:{show:!1}},yAxis:{axisLabel:{show:!0,fontSize:8,margin:2},splitNumber:3,type:"value"},series:[{type:"bar",data:t.turnover_data.map((t=>t["换手率"]))}]})))}}))}))}}},d=c,h=e(1656),u=(0,h.A)(d,o,i,!1,null,null,null),p=u.exports}}]);
//# sourceMappingURL=538.004041bf.js.map
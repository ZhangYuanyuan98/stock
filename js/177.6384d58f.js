"use strict";(self["webpackChunkstock"]=self["webpackChunkstock"]||[]).push([[177],{5556:function(t,a,e){e.r(a),e.d(a,{default:function(){return b}});var i=function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"app"}},[a("TopNavbar"),a("el-container",{staticStyle:{width:"100%",border:"1px solid #eee",display:"flex","justify-content":"center"}},[a("SideBar"),a("el-main",[a("div",{staticClass:"header-container"},[a("el-page-header",{attrs:{content:"详情页面"},on:{back:t.goBack}}),a("h1",{staticClass:"custom-text-center"},[t._v(t._s(t.stock_name))]),a("div",[a("button",{on:{click:function(a){return t.toggleFollow(t.symbol)}}},[a("span",[t._v(t._s(t.followStatusText))])]),a("button",{on:{click:function(a){return t.toggleBlack(t.symbol)}}},[a("span",[t._v(t._s(t.blackStatusText))])])])],1),a("el-table",{attrs:{data:t.realTimeData,border:"","show-header":!1}},[a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("最新价："+t._s(e.row["最新价"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("涨跌幅："+t._s(e.row["涨跌幅"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("今开："+t._s(e.row["今开"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("昨收："+t._s(e.row["昨收"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("最高："+t._s(e.row["最高"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("最低："+t._s(e.row["最低"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("成交量："+t._s(e.row["成交量"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("成交额："+t._s(e.row["成交额"]))])]}}])})],1),a("div",{ref:"chartWrapper"},[a("div",{ref:"dailyChartContainer",staticClass:"chart-container"}),a("div",{ref:"chartContainer",staticClass:"chart-container"})]),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("weekly")}}},[t._v("周k")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flow")}}},[t._v("流入流出资金")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flowMain")}}},[t._v("主力资金比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flowRetail")}}},[t._v("散户资金比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("amount")}}},[t._v("成交量")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("vol")}}},[t._v("成交额")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeRange")}}},[t._v("涨跌幅")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeAmount")}}},[t._v("涨跌额")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("amplitude")}}},[t._v("振幅")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeProportion")}}},[t._v("涨跌比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("turnover")}}},[t._v("换手率")])],1)])],1)],1)],1)},n=[],s=e(9671),r=e(2599),o=e(8158),h=e(6373),l=e(8626),c={computed:{currentBoardCode(){return this.$route.query.symbol},followStatusText(){return this.isStockFollowed(this.symbol)?"已关注":"未关注"},blackStatusText(){return this.isStockBlack(this.symbol)?"已拉黑":"未拉黑"}},components:{TopNavbar:r.A,SideBar:o.A},data(){return{realTimeData:[],dailyData:[],weeklyData:[],symbol:"",stock_name:"",currentChart:"weekly",followedStocks:JSON.parse(localStorage.getItem("followedStocks")||"[]"),blackStocks:JSON.parse(localStorage.getItem("blackStocks")||"[]"),sharedDataZoom:[{type:"inside",start:50,end:100,xAxisIndex:[0],filterMode:"empty"}]}},mounted(){this.symbol=this.$route.query.symbol,this.fetchData().then((()=>{this.$nextTick((()=>{this.initDailyCharts(),this.initWeeklyChart(),this.fetchAdditionalData().then((()=>{this.$nextTick((()=>{this.showChart(this.currentChart)}))}))}))})),this.observeChartWrapperResize()},beforeDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()},methods:{toggleFollow(t){this.toggleStockStatus("followedStocks",t)},toggleBlack(t){this.toggleStockStatus("blackStocks",t)},toggleStockStatus(t,a){console.log(`尝试切换状态，当前股票symbol: ${a}, 列表: ${t}`);const e=this[t],i=e.includes(a),n=i?e.filter((t=>t!==a)):[...e,a];console.log(`更新后的${t}:`,n),this[t]=n,localStorage.setItem(t,JSON.stringify(n)),console.log(`已将更新后的${t}保存至localStorage`)},isStockFollowed(t){return this.followedStocks.includes(t)},isStockBlack(t){return this.blackStocks.includes(t)},observeChartWrapperResize(){const t=this.$refs.chartWrapper;t&&"ResizeObserver"in window?(this.resizeObserver=new ResizeObserver((t=>{t.forEach((()=>{this.resizeChartDebounced()}))})),this.resizeObserver.observe(t)):console.warn("ResizeObserver is not supported in this browser.")},resizeChartDebounced:(0,l.debounce)((function(){this.dailyChartInstance&&this.dailyChartInstance.resize(),this.chartInstance&&this.chartInstance.resize()}),100),goBack(){this.$router.go(-1)},async fetchData(){const t={symbol:this.symbol},a=await(0,h.Zv)(t,"/api/stock_real_time"),e=a.data.stock_name;this.stock_name=e,this.realTimeData=a.data.real_data;const i=await(0,h.Zv)(t,"/api/stock_daily_klines");this.dailyData=i.data.data[0].daily_data;const n=await(0,h.Zv)(t,"/api/stock_weekly_klines");return this.weeklyData=n.data.data[0].weekly_data,Promise.resolve()},async fetchAdditionalData(){const t={symbol:this.symbol},a=await(0,h.Zv)(t,"/api/stock_message");return this.flowData=a.data.data[0].flow_data,this.flowMainData=a.data.data[0].flow_main_data,this.flowRetailData=a.data.data[0].flow_retail_data,this.amountData=a.data.data[0].amount_data,this.volData=a.data.data[0].vol_data,this.changeRangeData=a.data.data[0].change_range_data,this.changeAmountData=a.data.data[0].change_amount_data,this.amplitudeData=a.data.data[0].amplitude_data,this.changeProportionData=a.data.data[0].change_proportion_data,this.turnoverData=a.data.data[0].turnover_data,Promise.resolve()},initDailyCharts(){this.dailyChartInstance=s.Ts(this.$refs.dailyChartContainer);const t=this.dailyData.filter((t=>0!==t.开盘||0!==t.收盘||0!==t.最高||0!==t.最低)),a=t.flatMap((t=>[t.开盘,t.收盘,t.最高,t.最低])),e=a.length>0?.95*Math.min(...a):0,i=a.length>0?1.05*Math.max(...a):0;this.dailyOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:t.map((t=>{const a=t["时间"];return a.slice(5,7)+a.slice(8,10)})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{min:e,max:i,axisLabel:{showMinLabel:!1,showMaxLabel:!1,formatter:"{value}",show:!0},axisTick:{alignWithLabel:!0,length:0},type:"value",name:"价格（元）"},tooltip:{trigger:"axis",formatter:a=>{const e=t[a[0].dataIndex];let i=`时间: ${e["时间"]}<br/>\n                                          开盘: ${e["开盘"]}<br/>\n                                          收盘: ${e["收盘"]}<br/>\n                                          最高: ${e["最高"]}<br/>\n                                          最低: ${e["最低"]}<br/>`;return(e["看涨指标"]||e["看跌指标"])&&(i+=e["看涨指标"]?`看涨指标: ${e["看涨指标"]}<br/>`:"",i+=e["看跌指标"]?`看跌指标: ${e["看跌指标"]}<br/>`:""),i}},series:[{type:"candlestick",data:t.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]},this.dailyOption.dataZoom=this.sharedDataZoom,this.dailyChartInstance.setOption(this.dailyOption)},initWeeklyChart(){this.chartInstance=s.FP(this.$refs.chartContainer)||s.Ts(this.$refs.chartContainer),this.weeklyOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.weeklyData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{min:function(t){var a=t.min;return.95*a},max:function(t){var a=t.max;return 1.05*a},axisLabel:{showMinLabel:!1,showMaxLabel:!1,formatter:"{value}",show:!0},axisTick:{alignWithLabel:!0,length:0},type:"value",name:"价格（元）"},series:[{type:"candlestick",data:this.weeklyData.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]},this.chartInstance.setOption(this.weeklyOption)},initFlowChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer);const t=Math.max(...this.flowData.map((t=>t["流入资金净额"]))),a=Math.floor(Math.log10(t));this.flowOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}价格（元）`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.flowData.map((t=>t["流入资金净额"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#00FF00"}}}]},this.chartInstance.setOption(this.flowOption)},initFlowMainChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.flowMainOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowMainData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}},data:this.flowMainData.map((t=>t["主力净流入-净占比"]))}]},this.chartInstance.setOption(this.flowMainOption)},initFlowRetailChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.flowRetailOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowRetailData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}},data:this.flowRetailData.map((t=>t["小单净流入-净占比"]))}]},this.chartInstance.setOption(this.flowRetailOption)},initAmountChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer);const t=Math.max(...this.amountData.map((t=>t["成交量"]))),a=Math.floor(Math.log10(t));this.amountOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.amountData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}手`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.amountData.map((t=>t["成交量"]))}]},this.amountOption.dataZoom=this.sharedDataZoom,this.chartInstance.setOption(this.amountOption)},initVolChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer);const t=Math.max(...this.volData.map((t=>t["成交额"]))),a=Math.floor(Math.log10(t));this.volOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.volData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}价格`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.volData.map((t=>t["成交额"]))}]},this.chartInstance.setOption(this.volOption)},initChangeRangeChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.changeRangeOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeRangeData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeRangeData.map((t=>t.涨跌幅)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeRangeOption)},initChangeAmountChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.changeAmountOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeAmountData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"价格（元）"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeAmountData.map((t=>t.涨跌额)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeAmountOption)},initAmplitudeChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.amplitudeOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.amplitudeData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.amplitudeData.map((t=>t.振幅))}]},this.chartInstance.setOption(this.amplitudeOption)},initChangeProportionChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.changeProportionOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeProportionData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeProportionData.map((t=>t.涨跌比例)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeProportionOption)},initTurnoverChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=s.Ts(this.$refs.chartContainer),this.turnoverOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.turnoverData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.turnoverData.map((t=>t.换手率))}]},this.chartInstance.setOption(this.turnoverOption)},showChart(t){this.currentChart=t,"weekly"===t?this.initWeeklyChart():"flow"===t?this.initFlowChart():"flowMain"===t?this.initFlowMainChart():"flowRetail"===t?this.initFlowRetailChart():"amount"===t?this.initAmountChart():"vol"===t?this.initVolChart():"changeRange"===t?this.initChangeRangeChart():"changeAmount"===t?this.initChangeAmountChart():"amplitude"===t?this.initAmplitudeChart():"changeProportion"===t?this.initChangeProportionChart():"turnover"===t&&this.initTurnoverChart()}}},p=c,u=e(1656),d=(0,u.A)(p,i,n,!1,null,null,null),b=d.exports}}]);
//# sourceMappingURL=177.6384d58f.js.map
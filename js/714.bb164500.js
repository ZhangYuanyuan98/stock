"use strict";(self["webpackChunkstock"]=self["webpackChunkstock"]||[]).push([[714],{175:function(t,a,e){e.r(a),e.d(a,{default:function(){return b}});var n=function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"app"}},[a("TopNavbar"),a("el-container",{staticStyle:{width:"100%",border:"1px solid #eee",display:"flex","justify-content":"center"}},[a("SideBar"),a("el-main",[a("div",{staticClass:"header-container"},[a("el-page-header",{attrs:{content:"详情页面"},on:{back:t.goBack}}),a("h1",{staticClass:"custom-text-center"},["concept"===t.sectorType?a("router-link",{attrs:{to:{path:"/api/cons/concept",query:{boardID:t.boardID}}}},[t._v(" "+t._s(t.boardName)+" ")]):a("router-link",{attrs:{to:{path:"/api/cons/industry",query:{boardID:t.boardID}}}},[t._v(" "+t._s(t.boardName)+" ")])],1),a("div",[a("button",{on:{click:function(a){return t.toggleFollow(t.boardID)}}},[a("span",[t._v(t._s(t.followStatusText))])])])],1),a("el-table",{attrs:{data:t.realTimeData,border:"","show-header":!1}},[a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("最新价："+t._s(e.row["最新价"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("涨跌幅："+t._s(e.row["涨跌幅"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("涨跌额："+t._s(e.row["涨跌额"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("总市值："+t._s(e.row["总市值"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("换手率："+t._s(e.row["换手率"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("上涨家数："+t._s(e.row["上涨家数"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("下跌家数："+t._s(e.row["下跌家数"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("领涨股票："+t._s(e.row["领涨股票"]))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("领涨股票-涨跌幅："+t._s(e.row["领涨股票-涨跌幅"]))])]}}])})],1),a("div",{ref:"chartWrapper"},[a("div",{ref:"dailyChartContainer",staticClass:"chart-container"}),a("div",{ref:"chartContainer",staticClass:"chart-container"})]),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("weekly")}}},[t._v("周k")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flow")}}},[t._v("流入流出资金")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flowMain")}}},[t._v("主力资金比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("flowRetail")}}},[t._v("散户资金比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("amount")}}},[t._v("成交量")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("vol")}}},[t._v("成交额")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeRange")}}},[t._v("涨跌幅")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeAmount")}}},[t._v("涨跌额")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("amplitude")}}},[t._v("振幅")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeProportion")}}},[t._v("涨跌比例")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("changeNumber")}}},[t._v("涨跌停数量")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("continuousChangeNumber")}}},[t._v("连续涨跌停数量")]),a("el-button",{attrs:{plain:""},on:{click:function(a){return t.showChart("continuousBigChangeNumber")}}},[t._v("连续大幅涨跌停数量")])],1)])],1)],1)],1)},i=[],r=e(9671),s=e(2599),o=e(8158),h=e(6373),c=e(8626),l={computed:{currentBoardCode(){return this.$route.query.boardID},followStatusText(){return this.isSectorFollowed(this.boardID)?"已关注":"未关注"}},components:{TopNavbar:s.A,SideBar:o.A},props:{sectorType:{type:String,required:!0}},data(){return{realTimeData:[],dailyData:[],weeklyData:[],boardID:"",boardName:"",currentChart:"weekly",followedConcept:JSON.parse(localStorage.getItem("followedConcept")||"[]"),followedIndustry:JSON.parse(localStorage.getItem("followedIndustry")||"[]")}},mounted(){this.boardID=this.$route.query.boardID,this.fetchData().then((()=>{this.$nextTick((()=>{this.initDailyCharts(),this.initWeeklyChart(),this.fetchAdditionalData().then((()=>{this.$nextTick((()=>{this.showChart(this.currentChart)}))}))}))})),this.observeChartWrapperResize()},beforeDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()},methods:{toggleFollow(t){console.log("尝试切换关注状态，当前板块boardID:",t);let a=[],e="";if("concept"===this.sectorType)a=this.followedConcept,e="followedConcept";else{if("industry"!==this.sectorType)return void console.error("未知的sectorType:",this.sectorType);a=this.followedIndustry,e="followedIndustry"}const n=this.isSectorFollowed(t),i=n?a.filter((a=>a!==t)):[...a,t];console.log("更新后的关注列表:",i),"followedConcept"===e?this.followedConcept=i:"followedIndustry"===e&&(this.followedIndustry=i),localStorage.setItem(e,JSON.stringify(i)),console.log("已将更新后的关注列表保存至localStorage")},isSectorFollowed(t){let a=[];if("concept"===this.sectorType)a=this.followedConcept;else{if("industry"!==this.sectorType)return console.error("未知的sectorType:",this.sectorType),!1;a=this.followedIndustry}return a.includes(t)},observeChartWrapperResize(){const t=this.$refs.chartWrapper;t&&"ResizeObserver"in window?(this.resizeObserver=new ResizeObserver((t=>{t.forEach((()=>{this.resizeChartDebounced()}))})),this.resizeObserver.observe(t)):console.warn("ResizeObserver is not supported in this browser.")},resizeChartDebounced:(0,c.debounce)((function(){this.dailyChartInstance&&this.dailyChartInstance.resize(),this.chartInstance&&this.chartInstance.resize()}),100),goBack(){this.$router.go(-1)},async fetchData(){const t={boardID:this.boardID};let a="",e="",n="";"concept"===this.sectorType?(a="/api/board_concept",e="/api/board_concept_daily_klines",n="/api/board_concept_weekly_klines"):"industry"===this.sectorType&&(a="/api/board_industry",e="/api/board_industry_daily_klines",n="/api/board_industry_weekly_klines");const i=await(0,h.Zv)(t,a),r=i.data.sector_name;this.boardName=r,this.realTimeData=i.data.real_data;const s=await(0,h.Zv)(t,e);this.dailyData=s.data.data[0].daily_data;const o=await(0,h.Zv)(t,n);return this.weeklyData=o.data.data[0].weekly_data,Promise.resolve()},async fetchAdditionalData(){const t={boardID:this.boardID};let a="";"concept"===this.sectorType?a="/api/board_concept_message":"industry"===this.sectorType&&(a="/api/board_industry_message");const e=await(0,h.Zv)(t,a);return this.flowData=e.data.data[0].flow_data,this.flowMainData=e.data.data[0].flow_main_data,this.flowRetailData=e.data.data[0].flow_retail_data,this.amountData=e.data.data[0].amount_data,this.volData=e.data.data[0].vol_data,this.changeRangeData=e.data.data[0].change_range_data,this.changeAmountData=e.data.data[0].change_amount_data,this.amplitudeData=e.data.data[0].amplitude_data,this.changeProportionData=e.data.data[0].change_proportion_data,this.changeNumberData=e.data.data[0].change_number_data,this.continuousChangeNumberData=e.data.data[0].continuous_change_number_data,this.continuousBigChangeNumberData=e.data.data[0].continuous_big_change_number_data,Promise.resolve()},initDailyCharts(){this.dailyChartInstance=r.Ts(this.$refs.dailyChartContainer);const t=this.dailyData.filter((t=>0!==t.开盘||0!==t.收盘||0!==t.最高||0!==t.最低)),a=t.flatMap((t=>[t.开盘,t.收盘,t.最高,t.最低])),e=a.length>0?.95*Math.min(...a):0,n=a.length>0?1.05*Math.max(...a):0;this.dailyOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{axisLabel:{showMinLabel:!0,showMaxLabel:!0},type:"category",data:t.map((t=>{const a=t["时间"];return a.slice(5,7)+a.slice(8,10)}))},yAxis:{min:e,max:n,axisLabel:{showMinLabel:!1,showMaxLabel:!1,formatter:"{value}",show:!0},axisTick:{alignWithLabel:!0,length:0},type:"value",name:"价格（元）"},tooltip:{trigger:"axis",formatter:a=>{const e=t[a[0].dataIndex];let n=`时间: ${e["时间"]}<br/>\n                                          开盘: ${e["开盘"]}<br/>\n                                          收盘: ${e["收盘"]}<br/>\n                                          最高: ${e["最高"]}<br/>\n                                          最低: ${e["最低"]}<br/>`;return(e["看涨指标"]||e["看跌指标"])&&(n+=e["看涨指标"]?`看涨指标: ${e["看涨指标"]}<br/>`:"",n+=e["看跌指标"]?`看跌指标: ${e["看跌指标"]}<br/>`:""),n}},series:[{type:"candlestick",data:t.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]},this.dailyOption.dataZoom=this.sharedDataZoom,this.dailyChartInstance.setOption(this.dailyOption)},initWeeklyChart(){this.chartInstance=r.FP(this.$refs.chartContainer)||r.Ts(this.$refs.chartContainer),this.weeklyOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.weeklyData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{min:function(t){var a=t.min;return.95*a},max:function(t){var a=t.max;return 1.05*a},axisLabel:{showMinLabel:!1,showMaxLabel:!1,formatter:"{value}",show:!0},axisTick:{alignWithLabel:!0,length:0},type:"value",name:"价格（元）"},series:[{type:"candlestick",data:this.weeklyData.map((t=>[t.开盘,t.收盘,t.最高,t.最低]))}]},this.chartInstance.setOption(this.weeklyOption)},initFlowChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer);const t=Math.max(...this.flowData.map((t=>t["流入资金净额"]))),a=Math.floor(Math.log10(t));this.flowOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}价格（元）`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.flowData.map((t=>t["流入资金净额"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#00FF00"}}}]},this.chartInstance.setOption(this.flowOption)},initFlowMainChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.flowMainOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowMainData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.flowMainData.map((t=>t["主力净流入-净占比"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.flowMainOption)},initFlowRetailChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.flowRetailOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.flowRetailData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.flowRetailData.map((t=>t["小单净流入-净占比"])),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.flowRetailOption)},initAmountChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer);const t=Math.max(...this.amountData.map((t=>t["成交量"]))),a=Math.floor(Math.log10(t));this.amountOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.amountData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}手`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.amountData.map((t=>t["成交量"]))}]},this.chartInstance.setOption(this.amountOption)},initVolChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer);const t=Math.max(...this.volData.map((t=>t["成交额"]))),a=Math.floor(Math.log10(t));this.volOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.volData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:`*10^${a}价格（元）`,axisLabel:{formatter:function(t){const e=t/Math.pow(10,a);return e.toFixed(2)}}},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.volData.map((t=>t["成交额"]))}]},this.chartInstance.setOption(this.volOption)},initChangeRangeChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.changeRangeOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeRangeData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeRangeData.map((t=>t.涨跌幅)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeRangeOption)},initChangeAmountChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.changeAmountOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeAmountData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"价格（元）"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeAmountData.map((t=>t.涨跌额)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeAmountOption)},initAmplitudeChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.amplitudeOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.amplitudeData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.amplitudeData.map((t=>t.振幅))}]},this.chartInstance.setOption(this.amplitudeOption)},initChangeProportionChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.changeProportionOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeProportionData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"%"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeProportionData.map((t=>t.涨跌比例)),itemStyle:{color:function(t){var a=t.data;return a>0?"#FF0000":"#40bb40"}}}]},this.chartInstance.setOption(this.changeProportionOption)},initChangeNumberChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.changeNumberOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.changeNumberData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"支"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.changeNumberData.map((t=>t.涨跌停数量))}]},this.chartInstance.setOption(this.changeNumberOption)},initContinuousChangeNumberChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.continuousChangeNumberOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.continuousChangeNumberData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"支"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.continuousChangeNumberData.map((t=>t.连续涨跌停数量))}]},this.chartInstance.setOption(this.continuousChangeNumberOption)},initContinuousBigChangeNumberChart(){this.chartInstance?this.chartInstance.clear():this.chartInstance=r.Ts(this.$refs.chartContainer),this.continuousBigChangeNumberOption={grid:{left:"3%",right:"1%",top:"10%",bottom:"10%"},xAxis:{type:"category",data:this.continuousBigChangeNumberData.map((t=>{const a=t["时间"],e=a.slice(5,7)+a.slice(8,10);return e})),axisLabel:{showMinLabel:!0,showMaxLabel:!0}},yAxis:{type:"value",name:"支"},series:[{type:"bar",barWidth:"20%",barGap:"20%",barCategoryGap:"40%",data:this.continuousBigChangeNumberData.map((t=>t.连续大幅涨跌停数量))}]},this.chartInstance.setOption(this.continuousBigChangeNumberOption)},showChart(t){this.currentChart=t,"weekly"===t?this.initWeeklyChart():"flow"===t?this.initFlowChart():"flowMain"===t?this.initFlowMainChart():"flowRetail"===t?this.initFlowRetailChart():"amount"===t?this.initAmountChart():"vol"===t?this.initVolChart():"changeRange"===t?this.initChangeRangeChart():"changeAmount"===t?this.initChangeAmountChart():"amplitude"===t?this.initAmplitudeChart():"changeProportion"===t?this.initChangeProportionChart():"changeNumber"===t?this.initChangeNumberChart():"continuousChangeNumber"===t?this.initContinuousChangeNumberChart():"continuousBigChangeNumber"===t&&this.initContinuousBigChangeNumberChart()}}},u=l,p=e(1656),d=(0,p.A)(u,n,i,!1,null,null,null),b=d.exports}}]);
//# sourceMappingURL=714.bb164500.js.map